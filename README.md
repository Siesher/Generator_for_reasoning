# Generator for Reasoning Dataset

## Описание

Этот проект предназначен для автоматической генерации датасета reasoning-примеров на русском языке с помощью модели Cerebras (например, Qwen-3-235b).  
Скрипт позволяет создавать вопросы, рассуждения и ответы в различных стилях (Chain-of-Thought, Program-of-Thought, Skip-Thinking), а также выгружать готовый датасет на Hugging Face Hub.

## Основные возможности

- Генерация уникальных вопросов по заданным темам.
- Получение рассуждений и ответов в формате JSON с помощью API Cerebras.
- Поддержка нескольких стратегий рассуждения: CoT, PoT, Skip-Thinking.
- Параллельная генерация примеров для ускорения работы.
- Сохранение датасета в формате JSONL.
- Анализ длины примеров (гистограмма по токенам).
- Выгрузка датасета на Hugging Face Hub.

## Структура проекта

- `Make_Data_Ada_think.ipynb` — основной ноутбук для генерации reasoning-датасета.
- `qwen3_adaptive_reasoning_dataset.jsonl` — итоговый датасет для обучения моделей.
- `README.md` — описание проекта.

## Быстрый старт

1. Получите API-ключи Cerebras и добавьте их в переменную `API_KEYS` в ноутбуке.
2. Запустите ячейки для генерации вопросов и reasoning-примеров.
3. После завершения генерации датасет будет сохранён в файл `qwen3_adaptive_reasoning_dataset.jsonl`.
4. Для анализа длины примеров запустите соответствующую ячейку (гистограмма).
5. Для выгрузки датасета на Hugging Face используйте ячейки с `huggingface_hub`.

## Пример структуры одной записи

```json
{
  "messages": [
    {"role": "user", "content": "Вопрос..."},
    {"role": "assistant", "content": "<thought_type>CoT</thought_type>\n<think>\nРассуждение...\n</think>\nОтвет"}
  ]
}
```

## Требования

- Python 3.8+
- cerebras-cloud-sdk
- tqdm
- matplotlib (для гистограммы)
- huggingface_hub (для выгрузки)
- (опционально) tiktoken для подсчёта токенов

## Контакты

Вопросы и предложения: loxterpoi@gmail.com
